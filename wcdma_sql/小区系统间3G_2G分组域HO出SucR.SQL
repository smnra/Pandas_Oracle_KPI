    SELECT
        INTERSHO.WCEL_ID,
        INTERSHO.rpdate,
        INTERSHO.Cel_3_2G间分组域HO出SucR,
        INTERSHO.XCel_3_2G间分组域HO出SucR,
        INTERSHO.YCel_3_2G间分组域HO出SucR
    
    FROM
        (Select
            INTERSHO.WCEL_ID,
            to_char(INTERSHO.period_start_time,'YYYY-MM-DD-HH24') rpdate,

            ROUND(Decode(Sum(INTERSHO.IS_HHO_ATT_UL_DCH_Q_NRT + INTERSHO.IS_HHO_ATT_UE_TRX_PWR_NRT +
            INTERSHO.IS_HHO_ATT_DL_DPCH_PWR_NRT + INTERSHO.IS_HHO_ATT_CPICH_RSCP_NRT +
            INTERSHO.IS_HHO_ATT_CPICH_ECNO_NRT + INTERSHO.IS_HHO_ATT_IM_IMS_NRT +
            INTERSHO.IS_HHO_ATT_LB_CAPA_DL_NRT + INTERSHO.IS_HHO_ATT_LB_CAPA_UL_NRT +
            INTERSHO.IS_HHO_ATT_LB_PRX_TOT_NRT + INTERSHO.IS_HHO_ATT_LB_PTX_TOT_NRT +
            INTERSHO.IS_HHO_ATT_LB_RES_LIM_NRT + INTERSHO.IS_HHO_ATT_LB_RSVR_SC_NRT +
            INTERSHO.IS_HHO_ATT_SB_NRT), 0, 0, Sum(INTERSHO.SUCC_IS_HHO_UL_DCH_Q_NRT +
            INTERSHO.SUCC_IS_HHO_UE_TRX_PWR_NRT + INTERSHO.SUCC_IS_HHO_DL_DPCH_PWR_NRT +
            INTERSHO.SUCC_IS_HHO_CPICH_RSCP_NRT + INTERSHO.SUCC_IS_HHO_CPICH_ECNO_NRT +
            INTERSHO.SUCC_IS_HHO_IM_IMS_NRT + INTERSHO.SUCC_IS_HHO_LB_CAPA_DL_NRT +
            INTERSHO.SUCC_IS_HHO_LB_CAPA_UL_NRT + INTERSHO.SUCC_IS_HHO_LB_PRX_TOT_NRT +
            INTERSHO.SUCC_IS_HHO_LB_PTX_TOT_NRT + INTERSHO.SUCC_IS_HHO_LB_RES_LIM_NRT +
            INTERSHO.SUCC_IS_HHO_LB_RSVR_SC_NRT + INTERSHO.SUCC_IS_HHO_SB_NRT) /
            Sum(INTERSHO.IS_HHO_ATT_UL_DCH_Q_NRT + INTERSHO.IS_HHO_ATT_UE_TRX_PWR_NRT +
            INTERSHO.IS_HHO_ATT_DL_DPCH_PWR_NRT + INTERSHO.IS_HHO_ATT_CPICH_RSCP_NRT +
            INTERSHO.IS_HHO_ATT_CPICH_ECNO_NRT + INTERSHO.IS_HHO_ATT_IM_IMS_NRT +
            INTERSHO.IS_HHO_ATT_LB_CAPA_DL_NRT + INTERSHO.IS_HHO_ATT_LB_CAPA_UL_NRT +
            INTERSHO.IS_HHO_ATT_LB_PRX_TOT_NRT + INTERSHO.IS_HHO_ATT_LB_PTX_TOT_NRT +
            INTERSHO.IS_HHO_ATT_LB_RES_LIM_NRT + INTERSHO.IS_HHO_ATT_LB_RSVR_SC_NRT +
            INTERSHO.IS_HHO_ATT_SB_NRT))*100,2) As Cel_3_2G间分组域HO出SucR,
            
            Sum(INTERSHO.SUCC_IS_HHO_UL_DCH_Q_NRT + INTERSHO.SUCC_IS_HHO_UE_TRX_PWR_NRT +
            INTERSHO.SUCC_IS_HHO_DL_DPCH_PWR_NRT + INTERSHO.SUCC_IS_HHO_CPICH_RSCP_NRT +
            INTERSHO.SUCC_IS_HHO_CPICH_ECNO_NRT + INTERSHO.SUCC_IS_HHO_IM_IMS_NRT +
            INTERSHO.SUCC_IS_HHO_LB_CAPA_DL_NRT + INTERSHO.SUCC_IS_HHO_LB_CAPA_UL_NRT +
            INTERSHO.SUCC_IS_HHO_LB_PRX_TOT_NRT + INTERSHO.SUCC_IS_HHO_LB_PTX_TOT_NRT +
            INTERSHO.SUCC_IS_HHO_LB_RES_LIM_NRT + INTERSHO.SUCC_IS_HHO_LB_RSVR_SC_NRT +
            INTERSHO.SUCC_IS_HHO_SB_NRT) As XCel_3_2G间分组域HO出SucR,
            
            Sum(INTERSHO.IS_HHO_ATT_UL_DCH_Q_NRT + INTERSHO.IS_HHO_ATT_UE_TRX_PWR_NRT +
            INTERSHO.IS_HHO_ATT_DL_DPCH_PWR_NRT + INTERSHO.IS_HHO_ATT_CPICH_RSCP_NRT +
            INTERSHO.IS_HHO_ATT_CPICH_ECNO_NRT + INTERSHO.IS_HHO_ATT_IM_IMS_NRT +
            INTERSHO.IS_HHO_ATT_LB_CAPA_DL_NRT + INTERSHO.IS_HHO_ATT_LB_CAPA_UL_NRT +
            INTERSHO.IS_HHO_ATT_LB_PRX_TOT_NRT + INTERSHO.IS_HHO_ATT_LB_PTX_TOT_NRT +
            INTERSHO.IS_HHO_ATT_LB_RES_LIM_NRT + INTERSHO.IS_HHO_ATT_LB_RSVR_SC_NRT +
            INTERSHO.IS_HHO_ATT_SB_NRT) As YCel_3_2G间分组域HO出SucR
            
        From
            NOKRWW_PS_INTERSHO_MNC1_RAW INTERSHO

        Where
            INTERSHO.PERIOD_START_TIME >= To_Date(&start_dateTime, 'yyyy-mm-dd-hh24') And
            INTERSHO.PERIOD_START_TIME < To_Date(&end_datetime, 'yyyy-mm-dd-hh24')
            
        Group By
            INTERSHO.WCEL_ID,
            to_char(INTERSHO.period_start_time,'YYYY-MM-DD-HH24')
        )  INTERSHO
        
    WHERE
        (Cel_3_2G间分组域HO出SucR < 90 AND YCel_3_2G间分组域HO出SucR <> 0)

    ORDER BY
        Cel_3_2G间分组域HO出SucR


 
 
 